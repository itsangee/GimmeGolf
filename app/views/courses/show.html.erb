<div class="container">
  <div class="card-show-course">
    <div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">
        <% @course.photos.each_with_index do |photo,index| %>
          <div class="carousel-item <%="active" if index.zero? %>">
            <img src="<%= cl_image_path photo.key, height: 400, width: 400, crop: :fit %>" alt="<%=@course.name%>">
          </div>
        <% end %>
      </div>
      <button class="carousel-control-prev no-hover-color" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next no-hover-color" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  </div>
</div>

<div class="py-2">
  <form action="/courses" method="get">
    <div>
      <div class="position-relative">
        <input type="date" name="search" value="<%=params[:search]%>" placeholder="Search bookings..">
      </div>
      <div class="position-relative">
        <%# <select name="location" id="cars">
        <% @locations.each do |location| %>
          <%# <%= <option value="#{location}">location</option> %>
        <%# <% end %>
        <%# </select> %>
      </div>
    </div>
    <input type="submit" value="Search" class="btn btn-flat border" id="search-button">
  </form>
</div>

<%= form_with url: courses_path, method: :get, class: "d-flex" do %>
  <%= text_field_tag :query,
    params[:query],
    # class: "form-control",
    placeholder: "Find a location"
  %>
  <%= submit_tag "Search", class: "btn btn-primary" %>
  <%# dropdown to show all the locations available at choosen date %>
<% end %>





<h1><%= @course.name %> </h1>
<p> <small><%= @course.description %></small> </p>
<h2><%= pluralize @course.reviews.size, "review" %></h2>

<div>
  <% if @course.reviews.blank? %>
    Be the first to leave a review for <%= @course.name %>
  <% else %>
    <% @course.reviews.each do |review| %>
      <p><%= review.content %></p>
    <% end %>
  <% end %>
</div>
<%= simple_form_for([@course, @review]) do |f| %>
  <%= f.input :content %>
  <%= f.button :submit %>
<% end %>
<%= link_to "Back to all courses", courses_path %>


<h2> Showing Tee Times for: <%= @course.name %> on "DATE WHICH USER PICKED" </h2>
<div class="py-2">
  <form action="/courses" method="get">
    <div>
      <div class="position-relative">
        <input type="date" name="search" value="<%=params[:search]%>" placeholder="Search bookings..">
      </div>
      <div class="position-relative">
      </div>
    </div>
    <input type="submit" value="SELECT DATE" class="btn btn-flat border" id="search-button">
  </form>
</div>


<button>SHOW TIMES</button>


<% current_year = Date.current.year %>

<%# ========== PLEASE LEAVE THIS CODE ALONE AND DO YOUR CODE ABOVE IT ===================================== %>
<%# data-controller="show-attendees" %>
<%# data-action="click->show-attendees#revealAttendees" %>
<%# class="d-none" data-show-attendees-target="attendees" %>


<%# <div> %>
  <%# <div class="text-center"> %>
    <%# <h2><%= @today %>
    <%# <h2>Current attendees:</h2> %>
  <%# </div> %>
  <%# <div class="d-flex justify-content-center"> %>
    <%# <% @slots.each do |slot| %>
      <%# <div> %>
        <%# <button class="text-center"> %>
          <%# <%= slot.start_time.strftime("%I:%M %p") %>
        <%# </button> %>
        <%# <div class="border border-3"> %>
          <%# <% @attendee_bookings.each do |attendee| %>
            <%# <% if slot.start_time == attendee.game_start %>
              <%# <p ><%= attendee.user.email %>
            <%# <% end %>
          <%# <% end %>
        <%# </div> %>
      <%# </div> %>
    <%# <% end %>
  <%# </div> %>
<%# </div> %>

<% @slots.each do |slot| %>
  <p class="border border-2"><%= slot.start_time.strftime("%I:%M %p") %></p>
    <% if slot.todays_bookings_count.zero? %>
      <p>no bookings</p>
    <% else %>
      <% slot.bookings.each do |booking| %>
        <% if booking.date == @today %>
          <p>User = <%= booking.user.email%> - <%= booking.date %></p>
        <% end %>
      <% end %>
    <% end %>
<% end %>




<%# <div> %>
  <%# <%= simple_form_for [@course, @booking] do |f| %>
    <%# <%= f.input :game_start, collection: @course.slots_collection, required: true %>
    <%# <%= f.select :slot_id, @slots.map { |slot| ["Start time #{slot.start_time.strftime("at %I:%M %p")}", slot.id]} %>
    <%# <%= f.input :date, as: :date, html5: true, required: true %>
    <%# <%= f.submit "Book Slot", class: "button", id: "buy-btn" %>
  <%# <% end %>
<%# </div> %>

<div>
  <%= simple_form_for [@course, @booking] do |f| %>
    <%# <%= f.input :game_start, collection: @course.slots_collection, required: true %>
    <%= f.input :slot_id, collection: @course.slots_collection, required: true, label_method: :second, value_method: :first %>
    <%# <%= f.select :slot_id, @slots.map { |slot| ["Start time #{slot.start_time.strftime("at %I:%M %p")}", slot.id]} %>
    <%= f.input :date, as: :date, html5: true, required: true %>
    <%= f.submit "Book Slot", class: "button", id: "buy-btn" %>
  <% end %>

</div>


<p>User signed in? <%= user_signed_in? %></p>
<p>Current user: <%= current_user.email %> </p>
